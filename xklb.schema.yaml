# Rime schema settings
# encoding: utf-8

schema:
  schema_id: xklb
  name: å°é¹¤æ˜Ÿç¬”
  version: "6"
  author:
    - å‘æ˜äºº å¤§ç‰›
  dependencies:

switches:
  - name: ascii_mode
    reset: 0
  - name: full_shape
    reset: 0
  - name: simplification
    reset: 0
  - name: extended_charset
    reset: 0
  - name: ascii_punct
    reset: 0

  - options: [ _keyboard_menu ]
    states: [ "  é€‰å•"]
  - options: [_key_']
#    states: [é€ è¯]
  - name: ascii_mode
#    states: [ "ä¸­æ–‡", "  ğŸ†ï¸ " ]
    reset: 0
  - options: [_key_~]
    states: [åæŸ¥]
  - options: [_Keyboard_clip]
    states: [è´´æ¿]
#  - options: [_keyboard_cjbj]
#    states: [ç¼–è¾‘]
  - options: [_key_`]
    #states: [ä¸‡èƒ½]
  - options: [_key_M2T]
    states: [" â“‚ "]
  - options: [_key_Left]
    states: ["  â‡¦ "]
  - options: [_key_Right]
    states: ["ï¸ â‡¨  "]
  - options: [_key_Hide]
    states: [ " â€¹â€¹â€¹  "]

  - name: _hide_candidate
    reset: 1
  - name: _hide_comment
    reset: 0
  - name: _hide_key_hint
    reset: 0

  - name: emoji_cn   #Emojiå¼€å…³
#    reset: 0              # 1ä¸ºé»˜è®¤å¼€å¯
#    states: [ "ğŸˆšï¸ï¸\uFE0E", "ğŸˆ¶ï¸ï¸\uFE0F" ]


engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - affix_segmentor@xklbWXYZ
#    - affix_segmentor@xmfc
    - affix_segmentor@pinyin_simp
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
#    - table_translator@xklb_dz       #å•å­—ç½®å‰
    - table_translator
    - "lua_translator@Lunar_calendar_translator"
    - "lua_translator@date_translator"
    - "lua_translator@number_translator"
    - reverse_lookup_translator
    - table_translator@b_sms
    - table_translator@quanpinerfen
    - table_translator@xklbWXYZ
    - table_translator@xklbXX
    - table_translator@xklbYY
    - table_translator@xklbZZ
    - table_translator@a_yhck
    - history_translator@history
    - script_translator@pinyin_simp
#    - table_translator@xmfc
  filters:
    - simplifier
    - simplifier@simplification
    - simplifier@emoji_cn   #Emojiæ»¤é•œ
    - uniquifier
    - reverse_lookup_filter@quanpinerfen_lookup
    - reverse_lookup_filter@pinyin_simp_lookup
#    - reverse_lookup_filter@xmfc_lookup


speller:
  alphabet: "/;abcdefghijklmnopqrstuvwxyz"
  initials: ";abcdefghijklmnopqrstuvwxyz"
#  alphabet: "@/;abcdefghijklmnopqrstuvwxyz"
#  initials: "@;abcdefghijklmnopqrstuvwxyz"
#  finals: '/'
  delimiter: " '"
  auto_select: true #é¡¶å­—ä¸Šå±
  auto_select_unique_candidate: true
  auto_clear: max_length #manual|auto|max_length ç©ºç æŒ‰ä¸‹ä¸€é”®ç¡®è®¤æ¸…å±|ç©ºç è‡ªåŠ¨æ¸…|è¾¾åˆ°æœ€é•¿ç æ—¶åç é¡¶ä¸Šæ¸…å±
  algebra:       #æœ‰ç®€æœ‰å…¨
    - xform/([A-Z][0-9]?)+([A-Z][0-9]?)$/$2/
    - derive/.....A|....B|...C|..D|.E|F//
    - xform/.....U|.(.)...V|...W|..X|.Y|Z/$1/
    - derive/[0-9]$//
    - xform/[ABCDEF]$//
    - derive|^;|/|

#  algebra:       #æœ‰ç®€æ— å…¨
#    - xform/([A-Z][0-9]?)+([A-Z][0-9]?)$/$2/
#    - xform/.....U|.(.)...V|...W|..X|.Y|Z|.....A|....B|...C|..D|.E|F/$1/
#    - derive/[0-9]$//
#    - derive|^;|/|

translator:
  __include: /TS1
  dictionary: xklb
  initial_quality: 100
  enable_charset_filter: false
  enable_completion: true #é€ç æç¤º
  enable_encoder: false
  enable_sentence: false
  enable_user_dict: false
  encode_commit_history: false

simplification:
  opencc_config: s2t.json
  option_name: simplification
#  show_in_comment: true #å¼€å¯ç¼–ç æ»¤é•œ
  tips: all #ç®€ç¹å¯¹ç…§


history:
   input: oo
   size: 1 #é‡å¤å‰å‡ æ¬¡ä¸Šå±
   initial_quality: -1


#æ»¤é•œé…ç½®
emoji_cn:
  opencc_config: emoji.json   #é…ç½®æ–‡ä»¶
  option_name: emoji_cn    #ä¸çŠ¶æ€æ å¼€å…³çš„åç§°ä¸€è‡´
  tips: all    #å¼€å¯æ³¨é‡Š

#æç¤ºé…ç½®
TS1:
  comment_format:
    - xform/([A-Z][0-9]?)+([A-Z][0-9]?)$/$2/
    - xform/.....U|.(.)...V|...W|..X|.Y|Z|.....A|....B|...C|..D|.E|F/$1/
    - xform/([ABCDEF][0-9]?)$//
    - xform/([UVWXYZ][0-9]?)$//
    - xform|1||
    - xform|~||
TS2:
  comment_format:
    - xform/([A-Z][0-9]?)+([A-Z][0-9]?)$/$2/
    - xform/.....U|.(.)...V|...W|..X|.Y|Z|.....A|....B|...C|..D|.E|F/$1/
    - xform|1|_|
    - xform/^/ã€”/
    - xform/$/ã€•/
    - xform/ / /
TS3:
  comment_format:
    - xform/([A-Z][0-9]?)+([A-Z][0-9]?)$/$2/
    - xform/.....U|.(.)...V|...W|..X|.Y|Z|.....A|....B|...C|..D|.E|F/$1/
    - xform/([ABCDEF][0-9]?)$//
    - xform/([UVWXYZ][0-9]?)$//
    - xform|~||
#åæŸ¥é…ç½®
#â†“éŸ³ç åæŸ¥æ–¹æ¡ˆ
pinyin_simp_lookup:
  __include: /TS2
  tags: [pinyin_simp]
  dictionary: xklb #åæŸ¥å…¶ç 
  overwrite_comment: true
pinyin_simp:
  tag: pinyin_simp
  dictionary: pinyin_simp
  enable_sentence: true
  enable_completion: true
  enable_user_dict: false
  prefix: "~"
  tips: "ã€”å…¨æ‹¼ã€•"


#â†“å½¢ç åæŸ¥æ–¹æ¡ˆ
xmfc_lookup:
  __include: /TS2
  tags: [xmfc]
  dictionary: xklb #åæŸ¥å…¶ç 
  overwrite_comment: true
xmfc:
  tag: xmfc
  dictionary: xmfc
  enable_sentence: true
  enable_completion: true
  enable_user_dict: false
  prefix: "#"
  tips: "ã€”æç¤ºã€•"

xklb_dz:
  __include: /TS1
  dictionary: xklb_dz
  initial_quality: 100
  enable_sentence: false
  enable_completion: true #é€ç æç¤º
  enable_user_dict: false

b_sms:
  dictionary: ""
  user_dict: b_sms
  db_class: stabledb
  enable_sentence: false
  enable_completion: false
  initial_quality: 99 #ç”¨æˆ·è¯å’Œç³»ç»Ÿè¯é‡ç å±…å
  comment_format:
    - xform|~||

#äºŒåˆ†åæŸ¥æ–¹æ¡ˆ
quanpinerfen_lookup:
  __include: /TS2
  tags: [quanpinerfen]
  dictionary: xklb #åæŸ¥å…¶ç 
  overwrite_comment: true
quanpinerfen:
  tag: quanpinerfen
  dictionary: ""
  user_dict: quanpinerfen
  db_class: userdb
  enable_sentence: false
  enable_completion: true
  comment_format:
    - xform|~||

reverse_lookup:
  __include: /TS2
  dictionary: xklb_fc

xklbWXYZ:
  __include: /TS1
  tag: xklbWXYZ
  dictionary: xklb
  user_dict: a_yhck
# â†“ ç”¨æˆ·è¯å…¸æ ¼å¼ï¼Œtabledbï¼ˆæ–‡æœ¬ï¼‰ æˆ– userdb ï¼ˆäºŒè¿›åˆ¶ï¼‰ã€‚
  db_class: tabledb
#  db_class: userdb
  enable_charset_filter: false
  enable_completion: true
  enable_encoder: true
  enable_sentence: true
  enable_user_dict: true
  encode_commit_history: false
  preedit_format:
    - xform|1|_|
  prefix: "'"
  tips: "ã€”é€ è¯ã€•"
xklbXX:
  __include: /xklbWXYZ
  tag: xklbXX
  dictionary: xklb_X
  prefix: "~X"
  tips: "ã€”Xã€•"
xklbYY:
  __include: /xklbWXYZ
  tag: xklbYY
  dictionary: xklb_Y
  prefix: "~Y"
  tips: "ã€”Yã€•"
xklbZZ:
  __include: /xklbWXYZ
  tag: xklbZZ
  dictionary: xklb_Z
  prefix: "~Z"
  tips: "ã€”Zã€•"
a_yhck:
  __include: /TS3
  dictionary: ""
  user_dict: a_yhck
  db_class: stabledb
  enable_sentence: false
  enable_completion: true #é€ç æç¤º
  initial_quality: 99 #å¡«100åˆ™è‡ªé€ è¯é«˜äºç³»ç»Ÿè¯|å¡«99åˆ™è‡ªé€ è¯ä½äºç³»ç»Ÿè¯

punctuator:
  import_preset: default
  half_shape:
    '''' : [ 'â€˜', 'â€™' , '\', 'ï¹¨' ]

key_binder:
  import_preset: default
  bindings:
    - {accept: "Shift+space", send: space, when: composing}   #å°ç‹¼æ¯«è¾“å…¥æ³•ä¸­è¿›è¡Œå¼•å¯¼é€ è¯æ—¶çš„ä¸Šå±ç»„åˆé”®ï¼ˆShift+spaceï¼‰ï¼ŒåŒæ–‡è¾“å…¥æ³•åˆ™éœ€è¦ç‚¹å‡»å€™é€‰è¯ä¸Šå±
    - {accept: "space", send: 1, when: composing}   #å¼•å¯¼é€ è¯ä¸­ç©ºæ ¼ç­‰äºé¦–é€‰ï¼Œç©ºæ ¼å°±ä¸§å¤±äº†ä¸Šå±çš„åŠŸèƒ½ï¼ˆåœ¨å¼•å¯¼é€ è¯ä¸­ï¼‰
    - {accept: ";", send: 2, when: composing} #åˆ†å·æ¬¡é€‰


recognizer:
  import_preset: default
  patterns:
    reverse_lookup: "[a-z`]*`+[a-z`]*"
    xklbWXYZ: "^'[a-z)(,./:?!'][a-z0-9)(,./:?!']*'?$"
#    xklbWXYZ: "^'[a-z0-9)(,./:?!']*'?$"
    pinyin_simp: "^~[a-z']*'?$"
#    xmfc: "^#[a-z']*'?$"
#    retention_zi: "^[qwrtypsdfghjklzxcvbnm][a-z]([aeiou]{0,3})?$" #å…³é€ç æç¤ºæ—¶å¼€å¯
#    retention_ci: "^[qwrtypsdfghjklzxcvbnm][a-z][qwrtypsdfghjklzxcvbnm]([a-z][aeiou]{0,1})?$" #å…³é€ç æç¤ºæ—¶å¼€å¯
#    aeiou: "^[aei][a-z]*?$" #å…³é€ç æç¤ºæ—¶å¼€å¯
    b_sms: "^o[a-z]*?$"
    quanpinerfen: "^u[a-z]+?$"
    jsq: "^=[^a-z@]*?$"
